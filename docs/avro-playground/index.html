---
layout: default
title: Avro Logical Type Playground
description: Interactive playground to test custom Avro logical types including encryption and PII masking
---

<div class="container" style="padding-top: var(--space-2xl);">
  <div class="text-center mb-2xl">
    <h1>Playground</h1>
    <p class="lead" style="max-width: 600px; margin: 0 auto; color: var(--text-secondary);">
      Toggle custom logical types to see how values transform. This is a client-side approximation of the Java
      conversions in this repo.
    </p>
  </div>

  <div class="grid grid-2 mb-2xl">
    <!-- QueryRecord Section -->
    <div class="card">
      <div
        style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--space-md);">
        <h3>QueryRecord</h3>
        <div style="display: flex; gap: var(--space-xs);">
          <span class="badge">encrypted</span>
          <span class="badge">reversed</span>
        </div>
      </div>

      <p class="text-sm text-muted">Note: "encrypted" uses Base64 for demo purposes. Java uses AES-GCM.</p>

      <div style="display: grid; gap: var(--space-md);">
        <div>
          <label
            style="display: block; margin-bottom: var(--space-xs); font-size: var(--font-size-sm); color: var(--text-secondary);">Query
            Author (reversed)</label>
          <input id="author" type="text" value="Ada Lovelace"
            style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid var(--border-color); background: var(--bg-elevated); color: var(--text-primary);">
        </div>
        <div>
          <label
            style="display: block; margin-bottom: var(--space-xs); font-size: var(--font-size-sm); color: var(--text-secondary);">Secret
            Name (encrypted)</label>
          <input id="secret" type="text" value="my-secret"
            style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid var(--border-color); background: var(--bg-elevated); color: var(--text-primary);">
        </div>
        <button onclick="applyQuery()" class="btn btn-primary" style="justify-content: center;">Apply Logical
          Types</button>
      </div>

      <div style="margin-top: var(--space-xl);">
        <div style="display: flex; gap: var(--space-sm); margin-bottom: var(--space-sm); overflow-x: auto;">
          <button class="btn btn-secondary btn-sm" onclick="showTab('query', 'raw')">Raw</button>
          <button class="btn btn-secondary btn-sm" onclick="showTab('query', 'transformed')">Transformed</button>
          <button class="btn btn-secondary btn-sm" onclick="showTab('query', 'decrypted')">Round-trip</button>
        </div>

        <div id="query-raw" class="code-view">
          <pre id="queryRaw"></pre>
        </div>
        <div id="query-transformed" class="code-view" style="display: none;">
          <pre id="queryTransformed"></pre>
        </div>
        <div id="query-decrypted" class="code-view" style="display: none;">
          <pre id="queryDecrypted"></pre>
        </div>
      </div>
    </div>

    <!-- Contact Section -->
    <div class="card">
      <div
        style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: var(--space-md);">
        <h3>Contact Record</h3>
        <div style="display: flex; gap: var(--space-xs);">
          <span class="badge">email_lower</span>
          <span class="badge">phone_normalized</span>
        </div>
      </div>

      <div style="display: grid; gap: var(--space-md);">
        <div>
          <label
            style="display: block; margin-bottom: var(--space-xs); font-size: var(--font-size-sm); color: var(--text-secondary);">Email</label>
          <input id="email" type="text" value="User.Name@Example.COM"
            style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid var(--border-color); background: var(--bg-elevated); color: var(--text-primary);">
        </div>
        <div>
          <label
            style="display: block; margin-bottom: var(--space-xs); font-size: var(--font-size-sm); color: var(--text-secondary);">Phone</label>
          <input id="phone" type="text" value="+1 (555) 123-4567"
            style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid var(--border-color); background: var(--bg-elevated); color: var(--text-primary);">
        </div>
        <button onclick="applyContact()" class="btn btn-primary" style="justify-content: center;">Apply Logical
          Types</button>
      </div>

      <div style="margin-top: var(--space-xl);">
        <div style="display: flex; gap: var(--space-sm); margin-bottom: var(--space-sm); overflow-x: auto;">
          <button class="btn btn-secondary btn-sm" onclick="showTab('contact', 'raw')">Raw</button>
          <button class="btn btn-secondary btn-sm" onclick="showTab('contact', 'transformed')">Transformed</button>
          <button class="btn btn-secondary btn-sm" onclick="showTab('contact', 'decrypted')">Round-trip</button>
        </div>

        <div id="contact-raw" class="code-view">
          <pre id="contactRaw"></pre>
        </div>
        <div id="contact-transformed" class="code-view" style="display: none;">
          <pre id="contactTransformed"></pre>
        </div>
        <div id="contact-decrypted" class="code-view" style="display: none;">
          <pre id="contactDecrypted"></pre>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Tab switching logic
  function showTab(section, tabName) {
    const parent = document.getElementById(section + '-raw').parentElement;
    parent.querySelectorAll('.code-view').forEach(el => el.style.display = 'none');
    document.getElementById(section + '-' + tabName).style.display = 'block';
  }

  // Original Logic Preserved
  let queryRawCache = {};
  let queryTransformedCache = {};
  let queryDecryptedCache = {};
  let contactRawCache = {};
  let contactTransformedCache = {};
  let contactDecryptedCache = {};

  function reversed(val) {
    return val == null ? null : "Reversed" + val;
  }
  function encrypt(val) {
    // demo-only: Base64 to visualize change (not the same as AES conversion in Java)
    return val == null ? null : btoa(val);
  }
  function emailLower(val) {
    return val == null ? null : val.toLowerCase();
  }
  function phoneNormalize(val) {
    if (val == null) return null;
    const trimmed = val.trim();
    if (trimmed.startsWith("+")) {
      return "+" + trimmed.replace(/[^0-9]/g, "");
    }
    return trimmed.replace(/[^0-9]/g, "");
  }

  function applyQuery() {
    const author = document.getElementById("author").value;
    const secret = document.getElementById("secret").value;
    queryRawCache = {
      queryId: "demo-id",
      queryAuthor: author,
      secretName: secret,
      queryEngine: "demo-engine"
    };
    queryTransformedCache = {
      queryId: queryRawCache.queryId,
      queryAuthor: reversed(author),
      secretName: encrypt(secret),
      queryEngine: queryRawCache.queryEngine
    };
    queryDecryptedCache = {
      queryId: queryRawCache.queryId,
      queryAuthor: author,
      secretName: secret,
      queryEngine: queryRawCache.queryEngine
    };
    document.getElementById("queryRaw").textContent = JSON.stringify(queryRawCache, null, 2);
    document.getElementById("queryTransformed").textContent = JSON.stringify(queryTransformedCache, null, 2);
    document.getElementById("queryDecrypted").textContent = JSON.stringify(queryDecryptedCache, null, 2);
  }

  function applyContact() {
    const email = document.getElementById("email").value;
    const phone = document.getElementById("phone").value;
    contactRawCache = {
      email: email,
      phoneNumber: phone
    };
    contactTransformedCache = {
      email: emailLower(email),
      phoneNumber: phoneNormalize(phone),
      emailRaw: email,
      phoneRaw: phone
    };
    contactDecryptedCache = {
      email: email,
      phoneNumber: phone,
      emailRaw: email,
      phoneRaw: phone
    };
    document.getElementById("contactRaw").textContent = JSON.stringify(contactRawCache, null, 2);
    document.getElementById("contactTransformed").textContent = JSON.stringify(contactTransformedCache, null, 2);
    document.getElementById("contactDecrypted").textContent = JSON.stringify(contactDecryptedCache, null, 2);
  }

  // Initial run
  applyQuery();
  applyContact();
</script>